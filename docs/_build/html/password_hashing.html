

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Password hashing &mdash; PyNaCl 1.4.0.dev1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Encoders" href="encoding.html" />
    <link rel="prev" title="Hashing" href="hashing.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> PyNaCl
          

          
          </a>

          
            
            
              <div class="version">
                14
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="public.html">Public Key Encryption</a></li>
<li class="toctree-l1"><a class="reference internal" href="secret.html">Secret Key Encryption</a></li>
<li class="toctree-l1"><a class="reference internal" href="signing.html">Digital Signatures</a></li>
<li class="toctree-l1"><a class="reference internal" href="hashing.html">Hashing</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Password hashing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#hashers-and-parameters">Hashers and parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="#password-storage-and-verification">Password storage and verification</a></li>
<li class="toctree-l2"><a class="reference internal" href="#key-derivation">Key derivation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-level-constants-for-operation-and-memory-cost-tweaking">Module level constants for operation and memory cost tweaking</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="encoding.html">Encoders</a></li>
<li class="toctree-l1"><a class="reference internal" href="exceptions.html">Exceptions</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">Utilities</a></li>
</ul>
<p class="caption"><span class="caption-text">Api Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api/hash.html">nacl.hash</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/pwhash.html">nacl.pwhash</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/hashlib.html">nacl.hashlib</a></li>
</ul>
<p class="caption"><span class="caption-text">The PyNaCl open source project</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="doing-a-release.html">Doing A Release</a></li>
<li class="toctree-l1"><a class="reference internal" href="vectors/index.html">Reference vectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">PyNaCl</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Password hashing</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/password_hashing.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="password-hashing">
<span id="id1"></span><h1>Password hashing<a class="headerlink" href="#password-hashing" title="Permalink to this headline">¶</a></h1>
<p>Password hashing and password based key derivation mechanisms in
actual use are all based on the idea of iterating a hash function
many times on a combination of the password and a random <code class="docutils literal notranslate"><span class="pre">salt</span></code>,
which is stored along with the hash, and allows verifying a proposed
password while avoiding clear-text storage.</p>
<p>The latest developments in password hashing have been <em>memory-hard</em>
and <em>tunable</em> mechanisms, pioneered by <code class="docutils literal notranslate"><span class="pre">scrypt</span></code> <a class="reference internal" href="#sd2012" id="id2"><span>[SD2012]</span></a>,
and followed-on by the schemes submitted to the <strong>Password Hashing
Competition</strong> <a class="reference internal" href="#phc" id="id3"><span>[PHC]</span></a>.</p>
<p>The <a class="reference internal" href="api/pwhash.html#module-nacl.pwhash" title="nacl.pwhash"><code class="xref py py-mod docutils literal notranslate"><span class="pre">nacl.pwhash</span></code></a> module exposes both the <strong>PHC</strong> recommended
partially data dependent <code class="docutils literal notranslate"><span class="pre">argon2id</span></code> and the data independent <code class="docutils literal notranslate"><span class="pre">argon2i</span></code>
mechanisms alongside to the <code class="docutils literal notranslate"><span class="pre">scrypt</span></code> one.</p>
<p>In the case of password storage, it’s usually suggested to give preference to
data dependent mechanisms, therefore the default mechanism suggested by
<code class="docutils literal notranslate"><span class="pre">libsodium</span></code> since version 1.0.15, and therefore by <code class="docutils literal notranslate"><span class="pre">PyNaCl</span></code> since version
1.2 is <code class="docutils literal notranslate"><span class="pre">argon2id</span></code>.</p>
<p>If you think in your use-case the risk of potential timing-attacks stemming
from data-dependency is greater than the potential time/memory trade-offs
stemming out of data-independency, you should prefer <code class="docutils literal notranslate"><span class="pre">argon2i</span></code> to
<code class="docutils literal notranslate"><span class="pre">argon2id</span></code> or <code class="docutils literal notranslate"><span class="pre">scrypt</span></code></p>
<div class="section" id="hashers-and-parameters">
<h2>Hashers and parameters<a class="headerlink" href="#hashers-and-parameters" title="Permalink to this headline">¶</a></h2>
<p>PyNaCl exposes the functions and the associated parameters needed
to exploit the password hashing constructions in a uniform way
in the modules <a class="reference internal" href="api/pwhash.html#module-nacl.pwhash.argon2id" title="nacl.pwhash.argon2id"><code class="xref py py-mod docutils literal notranslate"><span class="pre">argon2id</span></code></a>,
<a class="reference internal" href="api/pwhash.html#module-nacl.pwhash.argon2i" title="nacl.pwhash.argon2i"><code class="xref py py-mod docutils literal notranslate"><span class="pre">argon2i</span></code></a> and <a class="reference internal" href="api/pwhash.html#module-nacl.pwhash.scrypt" title="nacl.pwhash.scrypt"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scrypt</span></code></a>,
therefore, if you need to change your choice of construction, you simply
need to replace one module name with another in the example below.</p>
<p>Further, if you just want to use a default choosen construction, you can
directly call <a class="reference internal" href="api/pwhash.html#nacl.pwhash.str" title="nacl.pwhash.str"><code class="xref py py-func docutils literal notranslate"><span class="pre">nacl.pwhash.str()</span></code></a> or <code class="xref py py-func docutils literal notranslate"><span class="pre">nacl.pwhash.kdf()</span></code>
to use the preferred construct in modular crypt password hashing
or key derivation mode.</p>
</div>
<div class="section" id="password-storage-and-verification">
<h2>Password storage and verification<a class="headerlink" href="#password-storage-and-verification" title="Permalink to this headline">¶</a></h2>
<p>All implementations of the modular crypt hasher <cite>str</cite> function
internally generate a random salt, and return a hash encoded
in ascii modular crypt format, which can be stored in a shadow-like file</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">nacl.pwhash</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">password</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;my password&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">nacl</span><span class="o">.</span><span class="n">pwhash</span><span class="o">.</span><span class="n">str</span><span class="p">(</span><span class="n">password</span><span class="p">))</span>
<span class="gp">...</span>
<span class="go">b&#39;$argon2id$v=19$m=65536,t=2,p=1$...&#39;</span>
<span class="go">b&#39;$argon2id$v=19$m=65536,t=2,p=1$...&#39;</span>
<span class="go">b&#39;$argon2id$v=19$m=65536,t=2,p=1$...&#39;</span>
<span class="go">b&#39;$argon2id$v=19$m=65536,t=2,p=1$...&#39;</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># if needed, each hasher is exposed</span>
<span class="gp">... </span><span class="c1"># in just the same way:</span>
<span class="gp">... </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">nacl</span><span class="o">.</span><span class="n">pwhash</span><span class="o">.</span><span class="n">scrypt</span><span class="o">.</span><span class="n">str</span><span class="p">(</span><span class="n">password</span><span class="p">))</span>
<span class="gp">...</span>
<span class="go">b&#39;$7$C6..../...&#39;</span>
<span class="go">b&#39;$7$C6..../...&#39;</span>
<span class="go">b&#39;$7$C6..../...&#39;</span>
<span class="go">b&#39;$7$C6..../...&#39;</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">nacl</span><span class="o">.</span><span class="n">pwhash</span><span class="o">.</span><span class="n">argon2i</span><span class="o">.</span><span class="n">str</span><span class="p">(</span><span class="n">password</span><span class="p">))</span>
<span class="gp">...</span>
<span class="go">b&#39;$argon2i$v=19$m=32768,t=4,p=1$...&#39;</span>
<span class="go">b&#39;$argon2i$v=19$m=32768,t=4,p=1$...&#39;</span>
<span class="go">b&#39;$argon2i$v=19$m=32768,t=4,p=1$...&#39;</span>
<span class="go">b&#39;$argon2i$v=19$m=32768,t=4,p=1$...&#39;</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># and</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">nacl</span><span class="o">.</span><span class="n">pwhash</span><span class="o">.</span><span class="n">argon2id</span><span class="o">.</span><span class="n">str</span><span class="p">(</span><span class="n">password</span><span class="p">))</span>
<span class="gp">...</span>
<span class="go">b&#39;$argon2id$v=19$m=65536,t=2,p=1$...&#39;</span>
<span class="go">b&#39;$argon2id$v=19$m=65536,t=2,p=1$...&#39;</span>
<span class="go">b&#39;$argon2id$v=19$m=65536,t=2,p=1$...&#39;</span>
<span class="go">b&#39;$argon2id$v=19$m=65536,t=2,p=1$...&#39;</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<p>To verify a user-proposed password, the <a class="reference internal" href="api/pwhash.html#nacl.pwhash.verify" title="nacl.pwhash.verify"><code class="xref py py-func docutils literal notranslate"><span class="pre">verify()</span></code></a>
function checks the stored hash prefix, and dispatches verification to
the correct checker, which in turn extracts the used salt, memory
and operation count parameters from the modular format string
and checks the compliance of the proposed password with the stored hash</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">nacl.pwhash</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hashed</span> <span class="o">=</span> <span class="p">(</span><span class="sa">b</span><span class="s1">&#39;$7$C6..../....qv5tF9KG2WbuMeUOa0TCoqwLHQ8s0TjQdSagne&#39;</span>
<span class="gp">... </span>          <span class="sa">b</span><span class="s1">&#39;9NvU0$3d218uChMvdvN6EwSvKHMASkZIG51XPIsZQDcktKyN7&#39;</span>
<span class="gp">... </span>          <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">correct</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;my password&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wrong</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;My password&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># while the result will be True on password match,</span>
<span class="gp">... </span><span class="c1"># on mismatch an exception will be raised</span>
<span class="gp">... </span><span class="n">res</span> <span class="o">=</span> <span class="n">nacl</span><span class="o">.</span><span class="n">pwhash</span><span class="o">.</span><span class="n">verify</span><span class="p">(</span><span class="n">hashed</span><span class="p">,</span> <span class="n">correct</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<span class="go">True</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res2</span> <span class="o">=</span> <span class="n">nacl</span><span class="o">.</span><span class="n">pwhash</span><span class="o">.</span><span class="n">verify_scryptsalsa208sha256</span><span class="p">(</span><span class="n">hashed</span><span class="p">,</span> <span class="n">wrong</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
    <span class="o">...</span>
<span class="gr">nacl.exceptions.InvalidkeyError</span>: <span class="n">Wrong password</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># the verify function raises an exception</span>
<span class="gp">... </span><span class="c1"># also when it is run against a password hash</span>
<span class="gp">... </span><span class="c1"># starting with a prefix it doesn&#39;t know</span>
<span class="gp">... </span><span class="n">wrong_hash</span> <span class="o">=</span> <span class="p">(</span><span class="sa">b</span><span class="s1">&#39;$?$C6..../....qv5tF9KG2WbuMeUOa0TCoqwLHQ8s0TjQdSagne&#39;</span>
<span class="gp">... </span>              <span class="sa">b</span><span class="s1">&#39;9NvU0$3d218uChMvdvN6EwSvKHMASkZIG51XPIsZQDcktKyN7&#39;</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">nacl</span><span class="o">.</span><span class="n">pwhash</span><span class="o">.</span><span class="n">verify</span><span class="p">(</span><span class="n">wrong_hash</span><span class="p">,</span> <span class="n">correct</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
    <span class="o">...</span>
<span class="gr">nacl.exceptions.CryptPrefixError</span>: <span class="n">given password_hash is not in a supported format</span>
</pre></div>
</div>
</div>
<div class="section" id="key-derivation">
<h2>Key derivation<a class="headerlink" href="#key-derivation" title="Permalink to this headline">¶</a></h2>
<p>Alice needs to send a secret message to Bob, using a shared
password to protect the content. She generates a random salt,
combines it with the password using one of the <cite>kdf</cite> functions
and sends the message along with the salt and key derivation
parameters.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">nacl</span> <span class="k">import</span> <span class="n">pwhash</span><span class="p">,</span> <span class="n">secret</span><span class="p">,</span> <span class="n">utils</span>


<span class="n">password</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;password shared between Alice and Bob&#39;</span>
<span class="n">message</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;This is a message for Bob&#39;s eyes only&quot;</span>

<span class="n">kdf</span> <span class="o">=</span> <span class="n">pwhash</span><span class="o">.</span><span class="n">argon2i</span><span class="o">.</span><span class="n">kdf</span>
<span class="n">salt</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">pwhash</span><span class="o">.</span><span class="n">argon2i</span><span class="o">.</span><span class="n">SALTBYTES</span><span class="p">)</span>
<span class="n">ops</span> <span class="o">=</span> <span class="n">pwhash</span><span class="o">.</span><span class="n">argon2i</span><span class="o">.</span><span class="n">OPSLIMIT_SENSITIVE</span>
<span class="n">mem</span> <span class="o">=</span> <span class="n">pwhash</span><span class="o">.</span><span class="n">argon2i</span><span class="o">.</span><span class="n">MEMLIMIT_SENSITIVE</span>

<span class="c1"># or, if there is a need to use scrypt:</span>
<span class="c1"># kdf = pwhash.scrypt.kdf</span>
<span class="c1"># salt = utils.random(pwhash.scrypt.SALTBYTES)</span>
<span class="c1"># ops = pwhash.scrypt.OPSLIMIT_SENSITIVE</span>
<span class="c1"># mem = pwhash.scrypt.MEMLIMIT_SENSITIVE</span>

<span class="n">Alices_key</span> <span class="o">=</span> <span class="n">kdf</span><span class="p">(</span><span class="n">secret</span><span class="o">.</span><span class="n">SecretBox</span><span class="o">.</span><span class="n">KEY_SIZE</span><span class="p">,</span> <span class="n">password</span><span class="p">,</span> <span class="n">salt</span><span class="p">,</span>
                 <span class="n">opslimit</span><span class="o">=</span><span class="n">ops</span><span class="p">,</span> <span class="n">memlimit</span><span class="o">=</span><span class="n">mem</span><span class="p">)</span>
<span class="n">Alices_box</span> <span class="o">=</span> <span class="n">secret</span><span class="o">.</span><span class="n">SecretBox</span><span class="p">(</span><span class="n">Alices_key</span><span class="p">)</span>
<span class="n">nonce</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">secret</span><span class="o">.</span><span class="n">SecretBox</span><span class="o">.</span><span class="n">NONCE_SIZE</span><span class="p">)</span>

<span class="n">encrypted</span> <span class="o">=</span> <span class="n">Alices_box</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">nonce</span><span class="p">)</span>

<span class="c1"># now Alice must send to Bob both the encrypted message</span>
<span class="c1"># and the KDF parameters: salt, opslimit and memlimit;</span>
<span class="c1"># using the same kdf mechanism, parameters **and password**</span>
<span class="c1"># Bob is able to derive the correct key to decrypt the message</span>


<span class="n">Bobs_key</span> <span class="o">=</span> <span class="n">kdf</span><span class="p">(</span><span class="n">secret</span><span class="o">.</span><span class="n">SecretBox</span><span class="o">.</span><span class="n">KEY_SIZE</span><span class="p">,</span> <span class="n">password</span><span class="p">,</span> <span class="n">salt</span><span class="p">,</span>
               <span class="n">opslimit</span><span class="o">=</span><span class="n">ops</span><span class="p">,</span> <span class="n">memlimit</span><span class="o">=</span><span class="n">mem</span><span class="p">)</span>
<span class="n">Bobs_box</span> <span class="o">=</span> <span class="n">secret</span><span class="o">.</span><span class="n">SecretBox</span><span class="p">(</span><span class="n">Bobs_key</span><span class="p">)</span>
<span class="n">received</span> <span class="o">=</span> <span class="n">Bobs_box</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">encrypted</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">received</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>This is a message for Bob&#39;s eyes only
</pre></div>
</div>
<p>if Eve manages to get the encrypted message, and tries to decrypt it
with a incorrect password, even if she does know all of the key
derivation parameters, she would derive a different key. Therefore
the decryption would fail and an exception would be raised</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ops, mem and salt are the same used by Alice</span>
<span class="gp">...</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">guessed_pw</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;I think Alice shared this password with Bob&#39;</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Eves_key</span> <span class="o">=</span> <span class="n">pwhash</span><span class="o">.</span><span class="n">argon2i</span><span class="o">.</span><span class="n">kdf</span><span class="p">(</span><span class="n">secret</span><span class="o">.</span><span class="n">SecretBox</span><span class="o">.</span><span class="n">KEY_SIZE</span><span class="p">,</span>
<span class="gp">... </span>                              <span class="n">guessed_pw</span><span class="p">,</span> <span class="n">salt</span><span class="p">,</span>
<span class="gp">... </span>                              <span class="n">opslimit</span><span class="o">=</span><span class="n">ops</span><span class="p">,</span> <span class="n">memlimit</span><span class="o">=</span><span class="n">mem</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Eves_box</span> <span class="o">=</span> <span class="n">secret</span><span class="o">.</span><span class="n">SecretBox</span><span class="p">(</span><span class="n">Eves_key</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">intercepted</span> <span class="o">=</span> <span class="n">Eves_box</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">encrypted</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
    <span class="o">...</span>
<span class="gr">nacl.exceptions.CryptoError</span>: <span class="n">Decryption failed. Ciphertext failed ...</span>
</pre></div>
</div>
<p>Contrary to the hashed password storage case where a serialization
format is well-defined, in the raw key derivation case the library
user must take care to store (and retrieve) both a reference to the kdf
used to derive the secret key and all the derivation parameters.
These parameters are needed to later generate the same secret key
from the password.</p>
<div class="section" id="module-level-constants-for-operation-and-memory-cost-tweaking">
<h3>Module level constants for operation and memory cost tweaking<a class="headerlink" href="#module-level-constants-for-operation-and-memory-cost-tweaking" title="Permalink to this headline">¶</a></h3>
<p>To help in selecting the correct values for the tweaking parameters for
the used construction, all the implementation modules provide suggested values
for the <cite>opslimit</cite> and <cite>memlimit</cite> parameters with the names:</p>
<blockquote>
<div><ul class="simple">
<li><p><cite>OPSLIMIT_INTERACTIVE</cite></p></li>
<li><p><cite>MEMLIMIT_INTERACTIVE</cite></p></li>
<li><p><cite>OPSLIMIT_SENSITIVE</cite></p></li>
<li><p><cite>MEMLIMIT_SENSITIVE</cite></p></li>
<li><p><cite>OPSLIMIT_MODERATE</cite></p></li>
<li><p><cite>MEMLIMIT_MODERATE</cite></p></li>
</ul>
</div></blockquote>
<p>and the corresponding minimum and maximum allowed values in:</p>
<blockquote>
<div><ul class="simple">
<li><p><cite>OPSLIMIT_MIN</cite></p></li>
<li><p><cite>MEMLIMIT_MIN</cite></p></li>
<li><p><cite>OPSLIMIT_MAX</cite></p></li>
<li><p><cite>MEMLIMIT_MAX</cite></p></li>
</ul>
</div></blockquote>
<p>Further, for each construction, pwhash modules expose the following
constants:</p>
<blockquote>
<div><ul class="simple">
<li><p><cite>STRPREFIX</cite></p></li>
<li><p><cite>PWHASH_SIZE</cite></p></li>
<li><p><cite>SALTBYTES</cite></p></li>
<li><p><cite>BYTES_MIN</cite></p></li>
<li><p><cite>BYTES_MAX</cite></p></li>
</ul>
</div></blockquote>
<p>In general, the _INTERACTIVE values are recommended in the case of hashes
stored for interactive password checking, and lead to a sub-second password
verification time, with a memory consumption in the tens of megabytes range,
while the _SENSITIVE values are meant to store hashes for password protecting
sensitive data, and lead to hashing times exceeding one second, with memory
consumption in the hundred of megabytes range. The _MODERATE values, suggested
for <code class="docutils literal notranslate"><span class="pre">argon2</span></code> mechanisms are meant to run the construct at a runtime and
memory cost intermediate between _INTERACTIVE and _SENSITIVE.</p>
<dl class="citation">
<dt class="label" id="sd2012"><span class="brackets"><a class="fn-backref" href="#id2">SD2012</a></span></dt>
<dd><p>A nice overview of password hashing history is available
in Solar Designer’s presentation
<a class="reference external" href="http://www.openwall.com/presentations/Passwords12-The-Future-Of-Hashing/">Password security: past, present, future</a></p>
</dd>
<dt class="label" id="phc"><span class="brackets"><a class="fn-backref" href="#id3">PHC</a></span></dt>
<dd><p>The Argon2 recommendation is prominently shown in the
<a class="reference external" href="https://password-hashing.net/">Password Hashing Competition</a>
site, along to the special recognition shortlist and the original
call for submissions.</p>
</dd>
</dl>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="encoding.html" class="btn btn-neutral float-right" title="Encoders" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="hashing.html" class="btn btn-neutral float-left" title="Hashing" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2013, Donald Stufft and Individual Contributors

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>