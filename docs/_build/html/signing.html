

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Digital Signatures &mdash; PyNaCl 1.4.0.dev1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Hashing" href="hashing.html" />
    <link rel="prev" title="Secret Key Encryption" href="secret.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> PyNaCl
          

          
          </a>

          
            
            
              <div class="version">
                14
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="public.html">Public Key Encryption</a></li>
<li class="toctree-l1"><a class="reference internal" href="secret.html">Secret Key Encryption</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Digital Signatures</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#example">Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id1">Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id2">Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="#reference">Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ed25519">Ed25519</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#algorithm">Algorithm</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="hashing.html">Hashing</a></li>
<li class="toctree-l1"><a class="reference internal" href="password_hashing.html">Password hashing</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="encoding.html">Encoders</a></li>
<li class="toctree-l1"><a class="reference internal" href="exceptions.html">Exceptions</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">Utilities</a></li>
</ul>
<p class="caption"><span class="caption-text">Api Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api/hash.html">nacl.hash</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/pwhash.html">nacl.pwhash</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/hashlib.html">nacl.hashlib</a></li>
</ul>
<p class="caption"><span class="caption-text">The PyNaCl open source project</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="doing-a-release.html">Doing A Release</a></li>
<li class="toctree-l1"><a class="reference internal" href="vectors/index.html">Reference vectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">PyNaCl</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Digital Signatures</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/signing.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="digital-signatures">
<h1>Digital Signatures<a class="headerlink" href="#digital-signatures" title="Permalink to this headline">¶</a></h1>
<p>You can use a digital signature for many of the same reasons that you might
sign a paper document. A valid digital signature gives a recipient reason to
believe that the message was created by a known sender such that they cannot
deny sending it (authentication and non-repudiation) and that the message was
not altered in transit (integrity).</p>
<p>Digital signatures allow you to publish a public key, and then you can use your
private signing key to sign messages. Others who have your public key can then
use it to validate that your messages are actually authentic.</p>
<div class="section" id="example">
<h2>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h2>
<p>Signing and verifying a message without encoding the key or message</p>
<p>Signer’s perspective (<a class="reference internal" href="#nacl.signing.SigningKey" title="nacl.signing.SigningKey"><code class="xref py py-class docutils literal notranslate"><span class="pre">SigningKey</span></code></a>)</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">nacl.signing</span> <span class="k">import</span> <span class="n">SigningKey</span>

<span class="c1"># Generate a new random signing key</span>
<span class="n">signing_key</span> <span class="o">=</span> <span class="n">SigningKey</span><span class="o">.</span><span class="n">generate</span><span class="p">()</span>

<span class="c1"># Sign a message with the signing key</span>
<span class="n">signed</span> <span class="o">=</span> <span class="n">signing_key</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;Attack at Dawn&quot;</span><span class="p">)</span>

<span class="c1"># Obtain the verify key for a given signing key</span>
<span class="n">verify_key</span> <span class="o">=</span> <span class="n">signing_key</span><span class="o">.</span><span class="n">verify_key</span>

<span class="c1"># Serialize the verify key to send it to a third party</span>
<span class="n">verify_key_bytes</span> <span class="o">=</span> <span class="n">verify_key</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
</pre></div>
</div>
<p>Verifier’s perspective (<a class="reference internal" href="#nacl.signing.VerifyKey" title="nacl.signing.VerifyKey"><code class="xref py py-class docutils literal notranslate"><span class="pre">VerifyKey</span></code></a>)</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">nacl.signing</span> <span class="k">import</span> <span class="n">VerifyKey</span>

<span class="c1"># Create a VerifyKey object from a hex serialized public key</span>
<span class="n">verify_key</span> <span class="o">=</span> <span class="n">VerifyKey</span><span class="p">(</span><span class="n">verify_key_bytes</span><span class="p">)</span>

<span class="c1"># Check the validity of a message&#39;s signature</span>
<span class="c1"># The message and the signature can either be passed together, or</span>
<span class="c1"># separately if the signature is decoded to raw bytes.</span>
<span class="c1"># These are equivalent:</span>
<span class="n">verify_key</span><span class="o">.</span><span class="n">verify</span><span class="p">(</span><span class="n">signed</span><span class="p">)</span>
<span class="n">verify_key</span><span class="o">.</span><span class="n">verify</span><span class="p">(</span><span class="n">signed</span><span class="o">.</span><span class="n">message</span><span class="p">,</span> <span class="n">signed</span><span class="o">.</span><span class="n">signature</span><span class="p">)</span>

<span class="c1"># Alter the signed message text</span>
<span class="n">forged</span> <span class="o">=</span> <span class="n">signed</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="nb">bytes</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">signed</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">^</span> <span class="mi">1</span><span class="p">])</span>
<span class="c1"># Will raise nacl.exceptions.BadSignatureError, since the signature check</span>
<span class="c1"># is failing</span>
<span class="n">verify_key</span><span class="o">.</span><span class="n">verify</span><span class="p">(</span><span class="n">forged</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Traceback (most recent call last):
 ...
nacl.exceptions.BadSignatureError: Signature was forged or corrupt
</pre></div>
</div>
</div>
<div class="section" id="id1">
<h2>Example<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>Signing and verifying a message encoded with HexEncoder</p>
<p>Signer’s perspective (<a class="reference internal" href="#nacl.signing.SigningKey" title="nacl.signing.SigningKey"><code class="xref py py-class docutils literal notranslate"><span class="pre">SigningKey</span></code></a>)</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">nacl.encoding</span> <span class="k">import</span> <span class="n">HexEncoder</span>
<span class="kn">from</span> <span class="nn">nacl.signing</span> <span class="k">import</span> <span class="n">SigningKey</span>

<span class="c1"># Generate a new random signing key</span>
<span class="n">signing_key</span> <span class="o">=</span> <span class="n">SigningKey</span><span class="o">.</span><span class="n">generate</span><span class="p">()</span>

<span class="c1"># Sign a message with the signing key</span>
<span class="n">signed_hex</span> <span class="o">=</span> <span class="n">signing_key</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;Attack at Dawn&quot;</span><span class="p">,</span> <span class="n">encoder</span><span class="o">=</span><span class="n">HexEncoder</span><span class="p">)</span>

<span class="c1"># Obtain the verify key for a given signing key</span>
<span class="n">verify_key</span> <span class="o">=</span> <span class="n">signing_key</span><span class="o">.</span><span class="n">verify_key</span>

<span class="c1"># Serialize the verify key to send it to a third party</span>
<span class="n">verify_key_hex</span> <span class="o">=</span> <span class="n">verify_key</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">encoder</span><span class="o">=</span><span class="n">HexEncoder</span><span class="p">)</span>
</pre></div>
</div>
<p>Verifier’s perspective (<a class="reference internal" href="#nacl.signing.VerifyKey" title="nacl.signing.VerifyKey"><code class="xref py py-class docutils literal notranslate"><span class="pre">VerifyKey</span></code></a>)</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">nacl.encoding</span> <span class="k">import</span> <span class="n">HexEncoder</span>
<span class="kn">from</span> <span class="nn">nacl.signing</span> <span class="k">import</span> <span class="n">VerifyKey</span>

<span class="c1"># Create a VerifyKey object from a hex serialized public key</span>
<span class="n">verify_key</span> <span class="o">=</span> <span class="n">VerifyKey</span><span class="p">(</span><span class="n">verify_key_hex</span><span class="p">,</span> <span class="n">encoder</span><span class="o">=</span><span class="n">HexEncoder</span><span class="p">)</span>

<span class="c1"># Check the validity of a message&#39;s signature</span>
<span class="c1"># The message and the signature can either be passed together, or</span>
<span class="c1"># separately if the signature is decoded to raw bytes.</span>
<span class="c1"># These are equivalent:</span>
<span class="n">verify_key</span><span class="o">.</span><span class="n">verify</span><span class="p">(</span><span class="n">signed_hex</span><span class="p">,</span> <span class="n">encoder</span><span class="o">=</span><span class="n">HexEncoder</span><span class="p">)</span>
<span class="n">signature_bytes</span> <span class="o">=</span> <span class="n">HexEncoder</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">signed_hex</span><span class="o">.</span><span class="n">signature</span><span class="p">)</span>
<span class="n">verify_key</span><span class="o">.</span><span class="n">verify</span><span class="p">(</span><span class="n">signed_hex</span><span class="o">.</span><span class="n">message</span><span class="p">,</span> <span class="n">signature_bytes</span><span class="p">,</span>
                  <span class="n">encoder</span><span class="o">=</span><span class="n">HexEncoder</span><span class="p">)</span>

<span class="c1"># Alter the signed message text</span>
<span class="n">forged</span> <span class="o">=</span> <span class="n">signed_hex</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="nb">bytes</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">signed_hex</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">^</span> <span class="mi">1</span><span class="p">])</span>
<span class="c1"># Will raise nacl.exceptions.BadSignatureError, since the signature check</span>
<span class="c1"># is failing</span>
<span class="n">verify_key</span><span class="o">.</span><span class="n">verify</span><span class="p">(</span><span class="n">forged</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Traceback (most recent call last):
 ...
nacl.exceptions.BadSignatureError: Signature was forged or corrupt
</pre></div>
</div>
</div>
<div class="section" id="id2">
<h2>Example<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>Signing and verifying a message encoded with Base64Encoder</p>
<p>Signer’s perspective (<a class="reference internal" href="#nacl.signing.SigningKey" title="nacl.signing.SigningKey"><code class="xref py py-class docutils literal notranslate"><span class="pre">SigningKey</span></code></a>)</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">nacl.encoding</span> <span class="k">import</span> <span class="n">Base64Encoder</span>
<span class="kn">from</span> <span class="nn">nacl.signing</span> <span class="k">import</span> <span class="n">SigningKey</span>

<span class="c1"># Generate a new random signing key</span>
<span class="n">signing_key</span> <span class="o">=</span> <span class="n">SigningKey</span><span class="o">.</span><span class="n">generate</span><span class="p">()</span>

<span class="c1"># Sign a message with the signing key</span>
<span class="n">signed_b64</span> <span class="o">=</span> <span class="n">signing_key</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;Attack at Dawn&quot;</span><span class="p">,</span> <span class="n">encoder</span><span class="o">=</span><span class="n">Base64Encoder</span><span class="p">)</span>

<span class="c1"># Obtain the verify key for a given signing key</span>
<span class="n">verify_key</span> <span class="o">=</span> <span class="n">signing_key</span><span class="o">.</span><span class="n">verify_key</span>

<span class="c1"># Serialize the verify key to send it to a third party</span>
<span class="n">verify_key_b64</span> <span class="o">=</span> <span class="n">verify_key</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">encoder</span><span class="o">=</span><span class="n">Base64Encoder</span><span class="p">)</span>
</pre></div>
</div>
<p>Verifier’s perspective (<a class="reference internal" href="#nacl.signing.VerifyKey" title="nacl.signing.VerifyKey"><code class="xref py py-class docutils literal notranslate"><span class="pre">VerifyKey</span></code></a>)</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">nacl.encoding</span> <span class="k">import</span> <span class="n">Base64Encoder</span>
<span class="kn">from</span> <span class="nn">nacl.signing</span> <span class="k">import</span> <span class="n">VerifyKey</span>

<span class="c1"># Create a VerifyKey object from a base64 serialized public key</span>
<span class="n">verify_key</span> <span class="o">=</span> <span class="n">VerifyKey</span><span class="p">(</span><span class="n">verify_key_b64</span><span class="p">,</span> <span class="n">encoder</span><span class="o">=</span><span class="n">Base64Encoder</span><span class="p">)</span>

<span class="c1"># Check the validity of a message&#39;s signature</span>
<span class="c1"># The message and the signature can either be passed together, or</span>
<span class="c1"># separately if the signature is decoded to raw bytes.</span>
<span class="c1"># These are equivalent:</span>
<span class="n">verify_key</span><span class="o">.</span><span class="n">verify</span><span class="p">(</span><span class="n">signed_b64</span><span class="p">,</span> <span class="n">encoder</span><span class="o">=</span><span class="n">Base64Encoder</span><span class="p">)</span>
<span class="n">signature_bytes</span> <span class="o">=</span> <span class="n">Base64Encoder</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">signed_b64</span><span class="o">.</span><span class="n">signature</span><span class="p">)</span>
<span class="n">verify_key</span><span class="o">.</span><span class="n">verify</span><span class="p">(</span><span class="n">signed_b64</span><span class="o">.</span><span class="n">message</span><span class="p">,</span> <span class="n">signature_bytes</span><span class="p">,</span>
                  <span class="n">encoder</span><span class="o">=</span><span class="n">Base64Encoder</span><span class="p">)</span>

<span class="c1"># Alter the signed message text</span>
<span class="n">forged</span> <span class="o">=</span> <span class="n">signed_b64</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="nb">bytes</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">signed_b64</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">^</span> <span class="mi">1</span><span class="p">])</span>
<span class="c1"># Will raise nacl.exceptions.BadSignatureError, since the signature check</span>
<span class="c1"># is failing</span>
<span class="n">verify_key</span><span class="o">.</span><span class="n">verify</span><span class="p">(</span><span class="n">forged</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Traceback (most recent call last):
 ...
nacl.exceptions.BadSignatureError: Signature was forged or corrupt
</pre></div>
</div>
</div>
<div class="section" id="reference">
<h2>Reference<a class="headerlink" href="#reference" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="nacl.signing.SigningKey">
<em class="property">class </em><code class="sig-prename descclassname">nacl.signing.</code><code class="sig-name descname">SigningKey</code><span class="sig-paren">(</span><em class="sig-param">seed</em>, <em class="sig-param">encoder</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nacl/signing.html#SigningKey"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nacl.signing.SigningKey" title="Permalink to this definition">¶</a></dt>
<dd><p>Private key for producing digital signatures using the Ed25519 algorithm.</p>
<p>Signing keys are produced from a 32-byte (256-bit) random seed value. This
value can be passed into the <a class="reference internal" href="#nacl.signing.SigningKey" title="nacl.signing.SigningKey"><code class="xref py py-class docutils literal notranslate"><span class="pre">SigningKey</span></code></a> as a
<code class="xref py py-func docutils literal notranslate"><span class="pre">bytes()</span></code> whose length is 32.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This <strong>must</strong> be protected and remain secret. Anyone who knows
the value of your <a class="reference internal" href="#nacl.signing.SigningKey" title="nacl.signing.SigningKey"><code class="xref py py-class docutils literal notranslate"><span class="pre">SigningKey</span></code></a> or its seed can
masquerade as you.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seed</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.7)"><em>bytes</em></a>) – Random 32-byte value (i.e. private key).</p></li>
<li><p><strong>encoder</strong> – A class that is able to decode the <code class="docutils literal notranslate"><span class="pre">seed</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="attribute">
<dt id="nacl.signing.SigningKey.verify_key">
<code class="sig-name descname">verify_key</code><a class="headerlink" href="#nacl.signing.SigningKey.verify_key" title="Permalink to this definition">¶</a></dt>
<dd><p>An instance of <a class="reference internal" href="#nacl.signing.VerifyKey" title="nacl.signing.VerifyKey"><code class="xref py py-class docutils literal notranslate"><span class="pre">VerifyKey</span></code></a> (i.e. public key)
that corresponds with the signing key.</p>
</dd></dl>

<dl class="method">
<dt id="nacl.signing.SigningKey.generate">
<em class="property">classmethod </em><code class="sig-name descname">generate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/nacl/signing.html#SigningKey.generate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nacl.signing.SigningKey.generate" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a random <a class="reference internal" href="#nacl.signing.SigningKey" title="nacl.signing.SigningKey"><code class="xref py py-class docutils literal notranslate"><span class="pre">SigningKey</span></code></a> object</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>An instance of <a class="reference internal" href="#nacl.signing.SigningKey" title="nacl.signing.SigningKey"><code class="xref py py-class docutils literal notranslate"><span class="pre">SigningKey</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="nacl.signing.SigningKey.sign">
<code class="sig-name descname">sign</code><span class="sig-paren">(</span><em class="sig-param">message</em>, <em class="sig-param">encoder</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nacl/signing.html#SigningKey.sign"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nacl.signing.SigningKey.sign" title="Permalink to this definition">¶</a></dt>
<dd><p>Sign a message using this key.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>message</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.7)"><em>bytes</em></a>) – The data to be signed.</p></li>
<li><p><strong>encoder</strong> – A class that is able to decode the signed message.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An instance of <a class="reference internal" href="#nacl.signing.SignedMessage" title="nacl.signing.SignedMessage"><code class="xref py py-class docutils literal notranslate"><span class="pre">SignedMessage</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="nacl.signing.VerifyKey">
<em class="property">class </em><code class="sig-prename descclassname">nacl.signing.</code><code class="sig-name descname">VerifyKey</code><span class="sig-paren">(</span><em class="sig-param">key</em>, <em class="sig-param">encoder</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nacl/signing.html#VerifyKey"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nacl.signing.VerifyKey" title="Permalink to this definition">¶</a></dt>
<dd><p>The public key counterpart to an Ed25519 <a class="reference internal" href="#nacl.signing.SigningKey" title="nacl.signing.SigningKey"><code class="xref py py-class docutils literal notranslate"><span class="pre">SigningKey</span></code></a>
for producing digital signatures.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.7)"><em>bytes</em></a>) – A serialized Ed25519 public key.</p></li>
<li><p><strong>encoder</strong> – A class that is able to decode the <code class="docutils literal notranslate"><span class="pre">key</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="nacl.signing.VerifyKey.verify">
<code class="sig-name descname">verify</code><span class="sig-paren">(</span><em class="sig-param">smessage</em>, <em class="sig-param">signature</em>, <em class="sig-param">encoder</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nacl/signing.html#VerifyKey.verify"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nacl.signing.VerifyKey.verify" title="Permalink to this definition">¶</a></dt>
<dd><p>Verifies the signature of a signed message.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>smessage</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.7)"><em>bytes</em></a>) – The signed message to verify. This is either
the original message or the concated signature and message.</p></li>
<li><p><strong>signature</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.7)"><em>bytes</em></a>) – The signature of the message to verify against.
If the value of <code class="docutils literal notranslate"><span class="pre">smessage</span></code> is the concated signature and message,
this parameter can be <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>encoder</strong> – A class that is able to decode the secret message and
signature.</p></li>
</ul>
</dd>
<dt class="field-even">Return bytes</dt>
<dd class="field-even"><p>The message if successfully verified.</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>nacl.exceptions.BadSignatureError</strong> – This is raised if the
signature is invalid.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="nacl.signing.SignedMessage">
<em class="property">class </em><code class="sig-prename descclassname">nacl.signing.</code><code class="sig-name descname">SignedMessage</code><a class="reference internal" href="_modules/nacl/signing.html#SignedMessage"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nacl.signing.SignedMessage" title="Permalink to this definition">¶</a></dt>
<dd><p>A bytes subclass that holds a messaged that has been signed by a
<a class="reference internal" href="#nacl.signing.SigningKey" title="nacl.signing.SigningKey"><code class="xref py py-class docutils literal notranslate"><span class="pre">SigningKey</span></code></a>.</p>
<dl class="attribute">
<dt id="nacl.signing.SignedMessage.signature">
<code class="sig-name descname">signature</code><a class="headerlink" href="#nacl.signing.SignedMessage.signature" title="Permalink to this definition">¶</a></dt>
<dd><p>The signature contained within the
<a class="reference internal" href="#nacl.signing.SignedMessage" title="nacl.signing.SignedMessage"><code class="xref py py-class docutils literal notranslate"><span class="pre">SignedMessage</span></code></a>.</p>
</dd></dl>

<dl class="attribute">
<dt id="nacl.signing.SignedMessage.message">
<code class="sig-name descname">message</code><a class="headerlink" href="#nacl.signing.SignedMessage.message" title="Permalink to this definition">¶</a></dt>
<dd><p>The message contained within the <a class="reference internal" href="#nacl.signing.SignedMessage" title="nacl.signing.SignedMessage"><code class="xref py py-class docutils literal notranslate"><span class="pre">SignedMessage</span></code></a>.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="ed25519">
<h2>Ed25519<a class="headerlink" href="#ed25519" title="Permalink to this headline">¶</a></h2>
<p>Ed25519 is a public-key signature system with several attractive features:</p>
<ul class="simple">
<li><p><strong>Fast single-signature verification:</strong> Ed25519 takes only 273364 cycles
to verify a signature on Intel’s widely deployed Nehalem/Westmere lines of
CPUs. (This performance measurement is for short messages; for very long
messages, verification time is dominated by hashing time.) Nehalem and
Westmere include all Core i7, i5, and i3 CPUs released between 2008 and
2010, and most Xeon CPUs released in the same period.</p></li>
<li><p><strong>Even faster batch verification:</strong> Ed25519 performs a batch of 64
separate signature verifications (verifying 64 signatures of 64 messages
under 64 public keys) in only 8.55 million cycles, i.e., under 134000
cycles per signature. Ed25519 fits easily into L1 cache, so contention
between cores is negligible: a quad-core 2.4GHz Westmere verifies 71000
signatures per second, while keeping the maximum verification latency
below 4 milliseconds.</p></li>
<li><p><strong>Very fast signing:</strong> Ed25519 takes only 87548 cycles to sign a
message. A quad-core 2.4GHz Westmere signs 109000 messages per second.</p></li>
<li><p><strong>Fast key generation:</strong> Key generation is almost as fast as signing. There
is a slight penalty for key generation to obtain a secure random number
from the operating system; /dev/urandom under Linux costs about 6000
cycles.</p></li>
<li><p><strong>High security level:</strong> This system has a 2^128 security target; breaking it
has similar difficulty to breaking NIST P-256, RSA with ~3000-bit keys,
strong 128-bit block ciphers, etc. The best attacks known actually cost
more than 2^140 bit operations on average, and degrade quadratically in
success probability as the number of bit operations drops.</p></li>
<li><p><strong>Collision resilience:</strong> Hash-function collisions do not break this system.
This adds a layer of defense against the possibility of weakness in the
selected hash function.</p></li>
<li><p><strong>No secret array indices:</strong> Ed25519 never reads or writes data from secret
addresses in RAM; the pattern of addresses is completely predictable.
Ed25519 is therefore immune to cache-timing attacks, hyperthreading
attacks, and other side-channel attacks that rely on leakage of addresses
through the CPU cache.</p></li>
<li><p><strong>No secret branch conditions:</strong> Ed25519 never performs conditional branches
based on secret data; the pattern of jumps is completely predictable.
Ed25519 is therefore immune to side-channel attacks that rely on leakage of
information through the branch-prediction unit.</p></li>
<li><p><strong>Small signatures:</strong> Ed25519 signatures are only 512-bits (64 bytes), one
of the smallest signature sizes available.</p></li>
<li><p><strong>Small keys:</strong> Ed25519 keys are only 256-bits (32 bytes), making them small
enough to easily copy and paste. Ed25519 also allows the public key to be
derived from the private key, meaning that it doesn’t need to be included
in a serialized private key in cases you want both.</p></li>
<li><p><strong>Deterministic:</strong> Unlike (EC)DSA, Ed25519 does not rely on an entropy
source when signing messages (which has lead to <a class="reference external" href="https://arstechnica.com/gaming/2010/12/ps3-hacked-through-poor-implementation-of-cryptography/">catastrophic private key</a>
compromises), but instead computes signature nonces from a combination of
a hash of the signing key’s “seed” and the message to be signed. This
avoids using an entropy source for nonces, which can be a potential attack
vector if the entropy source is not generating good random numbers. Even a
single reused nonce can lead to a complete disclosure of the private key in
these schemes, which Ed25519 avoids entirely by being deterministic instead
of tied to an entropy source.</p></li>
</ul>
<p>The numbers 87548 and 273364 shown above are official
<a class="reference external" href="https://bench.cr.yp.to/">eBATS</a> reports for a Westmere CPU (Intel Xeon E5620,
hydra2).</p>
<p>Ed25519 signatures are elliptic-curve signatures, carefully engineered at
several levels of design and implementation to achieve very high speeds without
compromising security.</p>
<div class="section" id="algorithm">
<h3>Algorithm<a class="headerlink" href="#algorithm" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><strong>Signatures:</strong> <a class="reference external" href="https://ed25519.cr.yp.to/">Ed25519 digital signature system</a></p></li>
</ul>
<img alt="_images/ed25519.png" src="_images/ed25519.png" />
<dl class="field-list simple">
<dt class="field-odd">k</dt>
<dd class="field-odd"><p>Ed25519 private key (passed into <a class="reference internal" href="#nacl.signing.SigningKey" title="nacl.signing.SigningKey"><code class="xref py py-class docutils literal notranslate"><span class="pre">SigningKey</span></code></a>)</p>
</dd>
<dt class="field-even">A</dt>
<dd class="field-even"><p>Ed25519 public key derived from k</p>
</dd>
<dt class="field-odd">M</dt>
<dd class="field-odd"><p>message to be signed</p>
</dd>
<dt class="field-even">R</dt>
<dd class="field-even"><p>a deterministic nonce value calculated from a combination of private key
data RH and the message M</p>
</dd>
<dt class="field-odd">S</dt>
<dd class="field-odd"><p>Ed25519 signature</p>
</dd>
</dl>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="hashing.html" class="btn btn-neutral float-right" title="Hashing" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="secret.html" class="btn btn-neutral float-left" title="Secret Key Encryption" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2013, Donald Stufft and Individual Contributors

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>